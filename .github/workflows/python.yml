# =========================
# File: requirements.txt
# =========================
# Pin or range-pin for reproducibility.
numpy>=1.24,<3.0
pandas>=2.0,<3.0

# =========================
# File: main.py
# =========================
"""
Entry script. Reads an env var and prints a small DataFrame.
WHY: Keep a deterministic, fast example CI step.
"""
import os
import pandas as pd

def run() -> int:
    name = os.getenv("NAME", "world")
    df = pd.DataFrame({"hello": [name], "answer": [42]})
    print(df.to_string(index=False))
    return 0

if __name__ == "__main__":
    raise SystemExit(run())

# ============================================================
# File: .github/workflows/python.yml   (GitHub Actions)
# ============================================================
name: Python CI

on:
  push:
    branches: [ "**" ]
  pull_request:
  workflow_dispatch:    # allow manual runs from the Actions tab
  schedule:
    - cron: "17 6 * * 1"  # optional weekly Monday run

jobs:
  run-python:
    runs-on: ubuntu-latest
    strategy:
      fail-fast: false
      matrix:
        python-version: ["3.10"]   # extend to ["3.10","3.11","3.12"] if needed
    steps:
      - name: Checkout
        uses: actions/checkout@v4

      - name: Setup Python
        uses: actions/setup-python@v5
        with:
          python-version: ${{ matrix.python-version }}
          cache: "pip"                     # WHY: speed up installs
          cache-dependency-path: requirements.txt

      - name: Install dependencies
        run: |
          python -m pip install --upgrade pip
          pip install -r requirements.txt

      - name: Run script
        env:
          NAME: GitHub
        run: |
          python main.py

      - name: Run unit tests (if you add them)
        run: |
          python -m pip install pytest
          pytest -q

      - name: Save output artifact (optional)
        if: always()
        run: |
          python - <<'PY'
          with open("output.txt","w") as f:
              f.write("Run completed.\n")
          PY
        # Upload artifacts you want to download from the UI
      - name: Upload artifact
        if: always()
        uses: actions/upload-artifact@v4
        with:
          name: run-output
          path: output.txt

# ============================================================
# OPTIONAL: Browser-based dev using GitHub Codespaces
# Create → Code → "Create codespace on main".
# Adding devcontainer improves reproducibility.
# ============================================================
# File: .devcontainer/devcontainer.json
{
  "name": "python-env",
  "image": "mcr.microsoft.com/devcontainers/python:3.10",
  "features": {}, 
  "postCreateCommand": "pip install -U pip && pip install -r requirements.txt",
  "customizations": {
    "vscode": {
      "settings": {
        "python.defaultInterpreterPath": "/usr/local/bin/python"
      },
      "extensions": [
        "ms-python.python",
        "ms-python.vscode-pylance"
      ]
    }
  }
}

# =========================
# OPTIONAL: README badge
# =========================
# Add this to README.md to show workflow status:
# [![Python CI](https://github.com/<OWNER>/<REPO>/actions/workflows/python.yml/badge.svg)](https://github.com/<OWNER>/<REPO>/actions/workflows/python.yml)
